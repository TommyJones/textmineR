<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>1. Start here • textmineR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="1. Start here">
<meta property="og:description" content="textmineR">
<meta property="og:image" content="https://www.rtextmineR.com/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">textmineR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.0.5.999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_start_here.html">1. Start here</a>
    </li>
    <li>
      <a href="../articles/b_document_clustering.html">2. document clustering</a>
    </li>
    <li>
      <a href="../articles/c_topic_modeling.html">3. Topic modeling</a>
    </li>
    <li>
      <a href="../articles/d_text_embeddings.html">4. Text embeddings</a>
    </li>
    <li>
      <a href="../articles/e_doc_summarization.html">5. Document summarization</a>
    </li>
    <li>
      <a href="../articles/f_tidytext_example.html">6. Using tidytext with textmineR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/TommyJones/textmineR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>1. Start here</h1>
                        <h4 data-toc-skip class="author">Thomas W.
Jones</h4>
            
            <h4 data-toc-skip class="date">2023-06-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TommyJones/textmineR/blob/HEAD/vignettes/a_start_here.Rmd" class="external-link"><code>vignettes/a_start_here.Rmd</code></a></small>
      <div class="hidden name"><code>a_start_here.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="why-textminer">Why textmineR?<a class="anchor" aria-label="anchor" href="#why-textminer"></a>
</h2>
<p>textmineR was created with three principles in mind:</p>
<ol style="list-style-type: decimal">
<li>Maximize interoperability within R’s ecosystem</li>
<li>Scaleable in terms of object storage and computation time</li>
<li>Syntax that is idiomatic to R</li>
</ol>
<p>R has many packages for text mining and natural language processing
(NLP). The <a href="https://CRAN.R-project.org/view=NaturalLanguageProcessing" class="external-link">CRAN
task view on natural language processing</a> lists 53 unique packages.
Some of these packages are interoperable. Some are not.</p>
<p>textmineR strives for maximum interoperability in three ways. First,
it uses the <code>dgCMatrix</code> class from the popular <a href="https://CRAN.R-project.org/package=Matrix" class="external-link"><code>Matrix</code>
package</a> for document term matrices (DTMs) and term co-occurrence
matrices (TCMs). The <code>Matrix</code> package is an R “recommended”
package with nearly 500 packages that depend, import, or suggest it.
Compare that to the <a href="https://CRAN.R-project.org/package=slam" class="external-link"><code>slam</code>
package</a> used by <a href="https://CRAN.R-project.org/package=tm" class="external-link"><code>tm</code></a> and its
derivatives. <code>slam</code> has an order of magnitude fewer
dependents. It is simply not as well integrated. <code>Matrix</code>
also has methods that make the syntax for manipulating its matrices
nearly identical to base R. This greatly reduces the cognitive burden of
the programmers.</p>
<p>Second, textmineR relies on base R objects for corpus and metadata
storage. Actually, it relies on the user to do so. textmineR’s core
functions <code>CreateDtm</code> and <code>CreateTcm</code> take a
simple character vector as input. Users may store their corpora as
character vectors, lists, or data frames. <em>There is no need to learn
a new <a href="https://CRAN.R-project.org/package=tm" class="external-link">‘Corpus’</a>
class.</em></p>
<p>Third and last, textmineR represents the output of topic models in a
consistent way, a list containing two matrices. This is described in
more detail in the next section. Several topic models are supported and
the simple representation means that textmineR’s utility functions are
usable with outputs from other packages, so long as they are represented
as matrices of probabilities. (Again, see the next section for more
detail.)</p>
<p>textmineR achieves scaleability through three means. First, sparse
matrices (like the <code>dgCMatrix</code>) offer significant memory
savings. Second, textmineR utilizes <code>Rcpp</code> throughout for
speedup. Finally, textmineR uses parallel processing by default where
possible. textmineR offers a function <code>TmParallelApply</code> which
implements a framework for parallel processing that is syntactically
agnostic between Windows and Unix-like operating systems.
<code>TmParallelApply</code> is used liberally within textmineR and is
exposed for users.</p>
<p>textmineR does make some tradeoffs of performance for syntactic
simplicity. textmineR is designed to run on a single node in a cluster
computing environment. It can (and will by default) use all available
cores of that node. If performance is your number one concern, see <a href="https://CRAN.R-project.org/package=text2vec" class="external-link"><code>text2vec</code></a>.
textmineR uses some <code>text2vec</code> under the hood.</p>
<p>textmineR strives for syntax that is idiomatic to R. This is,
admittedly, a nebulous concept. textmineR does not create new classes
where existing R classes exist. It strives for a functional programming
paradigm. And it attempts to group closely-related sequential steps into
single functions. This means that users will not have to make several
temporary objects along the way. As an example, compare making a
document term matrix in textmineR (example below) with <code>tm</code>
or <code>text2vec</code>.</p>
<p>As a side note: textmineR’s framework for NLP does not need to be
exclusive to textmineR. Text mining packages in R can be interoperable
with a few concepts. First, use <code>dgCMatrix</code> for DTMs and
TCMs. Second, write most text mining models in a way that they can take
a <code>dgCMatrix</code> as the input. Finally, keep non-base R classes
to a minimum, especially for corpus and metadata management.</p>
</div>
<div class="section level2">
<h2 id="corpus-management">Corpus management<a class="anchor" aria-label="anchor" href="#corpus-management"></a>
</h2>
<div class="section level4">
<h4 id="creating-a-dtm">Creating a DTM<a class="anchor" aria-label="anchor" href="#creating-a-dtm"></a>
</h4>
<p>The basic object of analysis for most text mining applications is a
document term matrix, or DTM. This is a matrix where every row
represents a document and every column represents a token (word,
bi-gram, stem, etc.)</p>
<p>You can create a DTM with textmineR by passing a character vector.
There are options for stopword removal, creation of n-grams, and other
standard data cleaning. There is an option for passing a stemming or
lemmatization function if you desire. (See <code><a href="../reference/CreateDtm.html">help(CreateDtm)</a></code>
for an example using Porter’s word stemmer.)</p>
<p>The code below uses a dataset of movie reviews included with the
<code>text2vec</code> package. This dataset is used for sentiment
analysis. In addition to the text of the reviews. There is a binary
variable indicating positive or negative sentiment. More on this
later…</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rtextminer.com/" class="external-link">textmineR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'textmineR'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:Matrix':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     update</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     update</span></span>
<span></span>
<span><span class="co"># load movie_review dataset from text2vec</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">movie_review</span>, package <span class="op">=</span> <span class="st">"text2vec"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">movie_review</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    5000 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ id       : chr  "5814_8" "2381_9" "7759_3" "3630_4" ...</span></span>
<span><span class="co">#&gt;  $ sentiment: int  1 1 0 0 1 1 0 0 0 1 ...</span></span>
<span><span class="co">#&gt;  $ review   : chr  "With all this stuff going down at the moment with MJ i've started listening to his music, watching the odd docu"| __truncated__ "\\\"The Classic War of the Worlds\\\" by Timothy Hines is a very entertaining film that obviously goes to great"| __truncated__ "The film starts with a manager (Nicholas Bell) giving welcome investors (Robert Carradine) to Primal Park . A s"| __truncated__ "It must be assumed that those who praised this film (\\\"the greatest filmed opera ever,\\\" didn't I read some"| __truncated__ ...</span></span>
<span></span>
<span><span class="co"># let's take a sample so the demo will run quickly</span></span>
<span><span class="co"># note: textmineR is generally quite scaleable, depending on your system</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">movie_review</span><span class="op">)</span>, <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="va">movie_review</span> <span class="op">&lt;-</span> <span class="va">movie_review</span><span class="op">[</span> <span class="va">s</span> , <span class="op">]</span></span>
<span></span>
<span><span class="co"># create a document term matrix </span></span>
<span><span class="va">dtm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CreateDtm.html">CreateDtm</a></span><span class="op">(</span>doc_vec <span class="op">=</span> <span class="va">movie_review</span><span class="op">$</span><span class="va">review</span>, <span class="co"># character vector of documents</span></span>
<span>                 doc_names <span class="op">=</span> <span class="va">movie_review</span><span class="op">$</span><span class="va">id</span>, <span class="co"># document names, optional</span></span>
<span>                 ngram_window <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># minimum and maximum n-gram length</span></span>
<span>                 stopword_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">stopwords</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html" class="external-link">stopwords</a></span><span class="op">(</span><span class="st">"en"</span><span class="op">)</span>, <span class="co"># stopwords from tm</span></span>
<span>                                  <span class="fu">stopwords</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stopwords/man/stopwords.html" class="external-link">stopwords</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"smart"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># this is the default value</span></span>
<span>                 lower <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># lowercase - this is the default value</span></span>
<span>                 remove_punctuation <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># punctuation - this is the default</span></span>
<span>                 remove_numbers <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># numbers - this is the default</span></span>
<span>                 verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Turn off status bar for this demo</span></span>
<span>                 cpus <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># by default, this will be the max number of cpus available</span></span>
<span><span class="co">#&gt; 'as(&lt;dgTMatrix&gt;, "dgCMatrix")' is deprecated.</span></span>
<span><span class="co">#&gt; Use 'as(., "CsparseMatrix")' instead.</span></span>
<span><span class="co">#&gt; See help("Deprecated") and help("Matrix-deprecated").</span></span></code></pre></div>
<p>Even though a <code>dgCMatrix</code> isn’t a traditional matrix, it
has methods that make it similar to standard R matrices.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1]   500 56023</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 500</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] 56023</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "aaa"           "aaa_ball"      "aaaaatch"      "aaaaatch_kah" </span></span>
<span><span class="co">#&gt; [5] "aage"          "aage_haugland"</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">colnames(dtm)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">aaa</td>
</tr>
<tr class="even">
<td align="left">aaa_ball</td>
</tr>
<tr class="odd">
<td align="left">aaaaatch</td>
</tr>
<tr class="even">
<td align="left">aaaaatch_kah</td>
</tr>
<tr class="odd">
<td align="left">aage</td>
</tr>
<tr class="even">
<td align="left">aage_haugland</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">rownames(dtm)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">4273_1</td>
</tr>
<tr class="even">
<td align="left">7112_4</td>
</tr>
<tr class="odd">
<td align="left">1891_3</td>
</tr>
<tr class="even">
<td align="left">6252_10</td>
</tr>
<tr class="odd">
<td align="left">9929_2</td>
</tr>
<tr class="even">
<td align="left">8970_10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="basic-corpus-statistics">Basic corpus statistics<a class="anchor" aria-label="anchor" href="#basic-corpus-statistics"></a>
</h2>
<p>The code below performs some basic corpus statistics. textmineR has a
built in function for getting term frequencies across the corpus. This
function <code>TermDocFreq</code> gives term frequencies (equivalent to
<code>colSums(dtm)</code>), the number of documents in which each term
appears (equivalent to <code>colSums(dtm &gt; 0)</code>), and an
inverse-document frequency (IDF) vector. The IDF vector can be used to
create a TF-IDF matrix.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># get counts of tokens across the corpus</span></span>
<span><span class="va">tf_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span><span class="op">(</span>dtm <span class="op">=</span> <span class="va">dtm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tf_mat</span><span class="op">)</span> </span>
<span><span class="co">#&gt; tibble [56,023 × 4] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ term     : chr [1:56023] "aaa" "aaa_ball" "aaaaatch" "aaaaatch_kah" ...</span></span>
<span><span class="co">#&gt;  $ term_freq: num [1:56023] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ doc_freq : int [1:56023] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ idf      : num [1:56023] 6.21 6.21 6.21 6.21 6.21 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># look at the most frequent tokens</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_mat</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_mat</span><span class="op">$</span><span class="va">term_freq</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Ten most frequent tokens</caption>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">br</td>
<td align="right">1990</td>
<td align="right">289</td>
<td align="right">0.5481814</td>
</tr>
<tr class="even">
<td align="left">br_br</td>
<td align="right">999</td>
<td align="right">289</td>
<td align="right">0.5481814</td>
</tr>
<tr class="odd">
<td align="left">film</td>
<td align="right">909</td>
<td align="right">294</td>
<td align="right">0.5310283</td>
</tr>
<tr class="even">
<td align="left">movie</td>
<td align="right">774</td>
<td align="right">290</td>
<td align="right">0.5447272</td>
</tr>
<tr class="odd">
<td align="left">good</td>
<td align="right">337</td>
<td align="right">209</td>
<td align="right">0.8722738</td>
</tr>
<tr class="even">
<td align="left">time</td>
<td align="right">252</td>
<td align="right">167</td>
<td align="right">1.0966143</td>
</tr>
<tr class="odd">
<td align="left">people</td>
<td align="right">238</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="even">
<td align="left">story</td>
<td align="right">230</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="odd">
<td align="left">great</td>
<td align="right">181</td>
<td align="right">125</td>
<td align="right">1.3862944</td>
</tr>
<tr class="even">
<td align="left">bad</td>
<td align="right">176</td>
<td align="right">121</td>
<td align="right">1.4188176</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># look at the most frequent bigrams</span></span>
<span><span class="va">tf_bigrams</span> <span class="op">&lt;-</span> <span class="va">tf_mat</span><span class="op">[</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">tf_mat</span><span class="op">$</span><span class="va">term</span>, <span class="st">"_"</span><span class="op">)</span> , <span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_bigrams</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_bigrams</span><span class="op">$</span><span class="va">term_freq</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Ten most frequent bi-grams</caption>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">br_br</td>
<td align="right">999</td>
<td align="right">289</td>
<td align="right">0.5481814</td>
</tr>
<tr class="even">
<td align="left">br_film</td>
<td align="right">41</td>
<td align="right">35</td>
<td align="right">2.6592600</td>
</tr>
<tr class="odd">
<td align="left">br_movie</td>
<td align="right">34</td>
<td align="right">31</td>
<td align="right">2.7806209</td>
</tr>
<tr class="even">
<td align="left">special_effects</td>
<td align="right">28</td>
<td align="right">24</td>
<td align="right">3.0365543</td>
</tr>
<tr class="odd">
<td align="left">film_br</td>
<td align="right">20</td>
<td align="right">17</td>
<td align="right">3.3813948</td>
</tr>
<tr class="even">
<td align="left">good_movie</td>
<td align="right">18</td>
<td align="right">17</td>
<td align="right">3.3813948</td>
</tr>
<tr class="odd">
<td align="left">low_budget</td>
<td align="right">18</td>
<td align="right">16</td>
<td align="right">3.4420194</td>
</tr>
<tr class="even">
<td align="left">waste_time</td>
<td align="right">17</td>
<td align="right">15</td>
<td align="right">3.5065579</td>
</tr>
<tr class="odd">
<td align="left">movie_br</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">3.5065579</td>
</tr>
<tr class="even">
<td align="left">movie_good</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">3.5755508</td>
</tr>
</tbody>
</table>
<p>It looks like we have stray html tags (“&lt;br&gt;”) in the
documents. These aren’t giving us any relevant information about
content. (Except, perhaps, that these documents were originally part of
web pages.)</p>
<p>The most intuitive approach, perhaps, is to strip these tags from our
documents, re-construct a document term matrix, and re-calculate the
objects as above. However, a simpler approach would be to simply remove
the tokens containing “br” from the DTM we already calculated. This is
much more computationally efficient and gives us the same result
anyway.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove offending tokens from the DTM</span></span>
<span><span class="va">dtm</span> <span class="op">&lt;-</span> <span class="va">dtm</span><span class="op">[</span> , <span class="op">!</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span>,</span>
<span>                                    <span class="st">"(^br$)|(_br$)|(^br_)"</span><span class="op">)</span> <span class="op">]</span></span>
<span></span>
<span><span class="co"># re-construct tf_mat and tf_bigrams</span></span>
<span><span class="va">tf_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tf_bigrams</span> <span class="op">&lt;-</span> <span class="va">tf_mat</span><span class="op">[</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">tf_mat</span><span class="op">$</span><span class="va">term</span>, <span class="st">"_"</span><span class="op">)</span> , <span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_mat</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_mat</span><span class="op">$</span><span class="va">term_freq</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">#&gt;    term      term_freq doc_freq   idf</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> film            909      294 0.531</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> movie           774      290 0.545</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> good            337      209 0.872</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> time            252      167 1.10 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> people          238      143 1.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> story           230      143 1.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> great           181      125 1.39 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> bad             176      121 1.42 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> made            170      140 1.27 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> character       169      108 1.53</span></span></code></pre></div>
<table class="table">
<caption>Ten most frequent terms, ‘&lt;br&gt;’ removed</caption>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">film</td>
<td align="right">909</td>
<td align="right">294</td>
<td align="right">0.5310283</td>
</tr>
<tr class="even">
<td align="left">movie</td>
<td align="right">774</td>
<td align="right">290</td>
<td align="right">0.5447272</td>
</tr>
<tr class="odd">
<td align="left">good</td>
<td align="right">337</td>
<td align="right">209</td>
<td align="right">0.8722738</td>
</tr>
<tr class="even">
<td align="left">time</td>
<td align="right">252</td>
<td align="right">167</td>
<td align="right">1.0966143</td>
</tr>
<tr class="odd">
<td align="left">people</td>
<td align="right">238</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="even">
<td align="left">story</td>
<td align="right">230</td>
<td align="right">143</td>
<td align="right">1.2517635</td>
</tr>
<tr class="odd">
<td align="left">great</td>
<td align="right">181</td>
<td align="right">125</td>
<td align="right">1.3862944</td>
</tr>
<tr class="even">
<td align="left">bad</td>
<td align="right">176</td>
<td align="right">121</td>
<td align="right">1.4188176</td>
</tr>
<tr class="odd">
<td align="left">made</td>
<td align="right">170</td>
<td align="right">140</td>
<td align="right">1.2729657</td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="right">169</td>
<td align="right">108</td>
<td align="right">1.5324769</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_bigrams</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_bigrams</span><span class="op">$</span><span class="va">term_freq</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Ten most frequent bi-grams, ‘&lt;br&gt;’ removed</caption>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">special_effects</td>
<td align="right">28</td>
<td align="right">24</td>
<td align="right">3.036554</td>
</tr>
<tr class="even">
<td align="left">good_movie</td>
<td align="right">18</td>
<td align="right">17</td>
<td align="right">3.381395</td>
</tr>
<tr class="odd">
<td align="left">low_budget</td>
<td align="right">18</td>
<td align="right">16</td>
<td align="right">3.442019</td>
</tr>
<tr class="even">
<td align="left">waste_time</td>
<td align="right">17</td>
<td align="right">15</td>
<td align="right">3.506558</td>
</tr>
<tr class="odd">
<td align="left">movie_good</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">3.575551</td>
</tr>
<tr class="even">
<td align="left">real_life</td>
<td align="right">14</td>
<td align="right">11</td>
<td align="right">3.816713</td>
</tr>
<tr class="odd">
<td align="left">watch_movie</td>
<td align="right">14</td>
<td align="right">13</td>
<td align="right">3.649659</td>
</tr>
<tr class="even">
<td align="left">watching_movie</td>
<td align="right">14</td>
<td align="right">13</td>
<td align="right">3.649659</td>
</tr>
<tr class="odd">
<td align="left">high_school</td>
<td align="right">13</td>
<td align="right">7</td>
<td align="right">4.268698</td>
</tr>
<tr class="even">
<td align="left">horror_films</td>
<td align="right">13</td>
<td align="right">8</td>
<td align="right">4.135167</td>
</tr>
</tbody>
</table>
<p>We can also calculate how many tokens each document contains from the
DTM. Note that this reflects the modifications we made in constructing
the DTM (removing stop words, punctuation, numbers, etc.).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># summary of document lengths</span></span>
<span><span class="va">doc_lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">doc_lengths</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;      20      97     139     188     222     928</span></span></code></pre></div>
<p>Often,it’s useful to prune your vocabulary and remove any tokens that
appear in a small number of documents. This will greatly reduce the
vocabulary size (see <a href="https://en.wikipedia.org/wiki/Zipf%27s_law" class="external-link">Zipf’s law</a>) and
improve computation time.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remove any tokens that were in 3 or fewer documents</span></span>
<span><span class="va">dtm</span> <span class="op">&lt;-</span> <span class="va">dtm</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">dtm</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">3</span> <span class="op">]</span> <span class="co"># alternatively: dtm[ , tf_mat$term_freq &gt; 3 ]</span></span>
<span></span>
<span><span class="va">tf_mat</span> <span class="op">&lt;-</span> <span class="va">tf_mat</span><span class="op">[</span> <span class="va">tf_mat</span><span class="op">$</span><span class="va">term</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span> , <span class="op">]</span></span>
<span></span>
<span><span class="va">tf_bigrams</span> <span class="op">&lt;-</span> <span class="va">tf_bigrams</span><span class="op">[</span> <span class="va">tf_bigrams</span><span class="op">$</span><span class="va">term</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span> , <span class="op">]</span></span></code></pre></div>
<p>The movie review data set contains more than just text of reviews. It
also contains a variable tagging the review as positive
(<code>movie_review$sentiment</code> <span class="math inline">\(=1\)</span>) or negative
(<code>movie_review$sentiment</code> <span class="math inline">\(=0\)</span>). We can examine terms associated with
positive and negative reviews. If we wanted, we could use them to build
a simple classifier.</p>
<p>However, as we will see immediately below, looking at only the most
frequent terms in each category is not helpful. Because of Zipf’s law,
the most frequent terms in just about <em>any</em> category will be the
same.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what words are most associated with sentiment?</span></span>
<span><span class="va">tf_sentiment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>positive <span class="op">=</span> <span class="fu"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">[</span> <span class="va">movie_review</span><span class="op">$</span><span class="va">sentiment</span> <span class="op">==</span> <span class="fl">1</span> , <span class="op">]</span><span class="op">)</span>,</span>
<span>                     negative <span class="op">=</span> <span class="fu"><a href="../reference/TermDocFreq.html">TermDocFreq</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">[</span> <span class="va">movie_review</span><span class="op">$</span><span class="va">sentiment</span> <span class="op">==</span> <span class="fl">0</span> , <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>These are basically the same. Not helpful at all.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">$</span><span class="va">term_freq</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Ten most-frequent positive tokens</caption>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">film</td>
<td align="right">483</td>
<td align="right">151</td>
<td align="right">0.4591837</td>
</tr>
<tr class="even">
<td align="left">movie</td>
<td align="right">340</td>
<td align="right">130</td>
<td align="right">0.6089291</td>
</tr>
<tr class="odd">
<td align="left">good</td>
<td align="right">180</td>
<td align="right">106</td>
<td align="right">0.8130245</td>
</tr>
<tr class="even">
<td align="left">great</td>
<td align="right">142</td>
<td align="right">93</td>
<td align="right">0.9438641</td>
</tr>
<tr class="odd">
<td align="left">time</td>
<td align="right">138</td>
<td align="right">88</td>
<td align="right">0.9991267</td>
</tr>
<tr class="even">
<td align="left">story</td>
<td align="right">124</td>
<td align="right">75</td>
<td align="right">1.1589754</td>
</tr>
<tr class="odd">
<td align="left">people</td>
<td align="right">107</td>
<td align="right">65</td>
<td align="right">1.3020763</td>
</tr>
<tr class="even">
<td align="left">films</td>
<td align="right">102</td>
<td align="right">56</td>
<td align="right">1.4511119</td>
</tr>
<tr class="odd">
<td align="left">love</td>
<td align="right">82</td>
<td align="right">53</td>
<td align="right">1.5061716</td>
</tr>
<tr class="even">
<td align="left">made</td>
<td align="right">81</td>
<td align="right">67</td>
<td align="right">1.2717709</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">$</span><span class="va">term_freq</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Ten most-frequent negative tokens</caption>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">movie</td>
<td align="right">434</td>
<td align="right">160</td>
<td align="right">0.4893466</td>
</tr>
<tr class="even">
<td align="left">film</td>
<td align="right">426</td>
<td align="right">143</td>
<td align="right">0.6016758</td>
</tr>
<tr class="odd">
<td align="left">good</td>
<td align="right">157</td>
<td align="right">103</td>
<td align="right">0.9297914</td>
</tr>
<tr class="even">
<td align="left">people</td>
<td align="right">131</td>
<td align="right">78</td>
<td align="right">1.2078116</td>
</tr>
<tr class="odd">
<td align="left">bad</td>
<td align="right">130</td>
<td align="right">82</td>
<td align="right">1.1578012</td>
</tr>
<tr class="even">
<td align="left">time</td>
<td align="right">114</td>
<td align="right">79</td>
<td align="right">1.1950726</td>
</tr>
<tr class="odd">
<td align="left">story</td>
<td align="right">106</td>
<td align="right">68</td>
<td align="right">1.3450127</td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="right">95</td>
<td align="right">60</td>
<td align="right">1.4701758</td>
</tr>
<tr class="odd">
<td align="left">made</td>
<td align="right">89</td>
<td align="right">73</td>
<td align="right">1.2740610</td>
</tr>
<tr class="even">
<td align="left">make</td>
<td align="right">86</td>
<td align="right">63</td>
<td align="right">1.4213857</td>
</tr>
</tbody>
</table>
<p>That was unhelpful. Instead, we need to re-weight the terms in each
class. We’ll use a probabilistic reweighting, described below.</p>
<p>The most frequent words in each class are proportional to <span class="math inline">\(P(word|sentiment_j)\)</span>. As we saw above,
that would puts the words in the same order as <span class="math inline">\(P(word)\)</span>, overall. However, we can use the
difference in those probabilities to get a new order. That difference
is</p>
<p><span class="math display">\[\begin{align}
  P(word|sentiment_j) - P(word)
\end{align}\]</span></p>
<p>You can interpret the difference in (1) as follows: Positive values
are more probable in the sentiment class than in the corpus overall.
Negative values are less probable. Values close to zero are
statistically-independent of sentiment. Since most of the top words are
the same when we sort by <span class="math inline">\(P(word|sentiment_j)\)</span>, these words are
statistically-independent of sentiment. They get forced towards
zero.</p>
<p>For those paying close attention, this difference should give a
similar ordering as pointwise-mutual information (PMI), defined as <span class="math inline">\(PMI =
\frac{P(word|sentiment_j)}{P(word)}\)</span>. However, I prefer the
difference as it is bound between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>.</p>
<p>The difference method is applied to both words overall and bi-grams
in the code below.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># let's reweight by probability by class</span></span>
<span><span class="va">p_words</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dtm</span><span class="op">)</span> <span class="co"># alternatively: tf_mat$term_freq / sum(tf_mat$term_freq)</span></span>
<span></span>
<span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">$</span><span class="va">conditional_prob</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">$</span><span class="va">term_freq</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">$</span><span class="va">term_freq</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">$</span><span class="va">prob_lift</span> <span class="op">&lt;-</span> <span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">$</span><span class="va">conditional_prob</span> <span class="op">-</span> <span class="va">p_words</span></span>
<span></span>
<span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">$</span><span class="va">conditional_prob</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">$</span><span class="va">term_freq</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">$</span><span class="va">term_freq</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">$</span><span class="va">prob_lift</span> <span class="op">&lt;-</span> <span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">$</span><span class="va">conditional_prob</span> <span class="op">-</span> <span class="va">p_words</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># let's look again with new weights</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">positive</span><span class="op">$</span><span class="va">prob_lift</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant terms for positive
sentiment</caption>
<colgroup>
<col width="18%">
<col width="14%">
<col width="13%">
<col width="14%">
<col width="24%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">great</td>
<td align="right">142</td>
<td align="right">93</td>
<td align="right">0.9438641</td>
<td align="right">0.0084009</td>
<td align="right">0.0029998</td>
</tr>
<tr class="even">
<td align="left">film</td>
<td align="right">483</td>
<td align="right">151</td>
<td align="right">0.4591837</td>
<td align="right">0.0285748</td>
<td align="right">0.0014502</td>
</tr>
<tr class="odd">
<td align="left">love</td>
<td align="right">82</td>
<td align="right">53</td>
<td align="right">1.5061716</td>
<td align="right">0.0048512</td>
<td align="right">0.0012406</td>
</tr>
<tr class="even">
<td align="left">films</td>
<td align="right">102</td>
<td align="right">56</td>
<td align="right">1.4511119</td>
<td align="right">0.0060344</td>
<td align="right">0.0010810</td>
</tr>
<tr class="odd">
<td align="left">performance</td>
<td align="right">55</td>
<td align="right">32</td>
<td align="right">2.0107276</td>
<td align="right">0.0032539</td>
<td align="right">0.0008667</td>
</tr>
<tr class="even">
<td align="left">role</td>
<td align="right">52</td>
<td align="right">38</td>
<td align="right">1.8388774</td>
<td align="right">0.0030764</td>
<td align="right">0.0008384</td>
</tr>
<tr class="odd">
<td align="left">charlie</td>
<td align="right">28</td>
<td align="right">3</td>
<td align="right">4.3778513</td>
<td align="right">0.0016565</td>
<td align="right">0.0007911</td>
</tr>
<tr class="even">
<td align="left">excellent</td>
<td align="right">36</td>
<td align="right">31</td>
<td align="right">2.0424763</td>
<td align="right">0.0021298</td>
<td align="right">0.0006975</td>
</tr>
<tr class="odd">
<td align="left">performances</td>
<td align="right">34</td>
<td align="right">21</td>
<td align="right">2.4319411</td>
<td align="right">0.0020115</td>
<td align="right">0.0006687</td>
</tr>
<tr class="even">
<td align="left">time</td>
<td align="right">138</td>
<td align="right">88</td>
<td align="right">0.9991267</td>
<td align="right">0.0081642</td>
<td align="right">0.0006445</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">tf_sentiment</span><span class="op">$</span><span class="va">negative</span><span class="op">$</span><span class="va">prob_lift</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant terms for negative
sentiment</caption>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">movie</td>
<td align="right">434</td>
<td align="right">160</td>
<td align="right">0.4893466</td>
<td align="right">0.0261304</td>
<td align="right">0.0030342</td>
</tr>
<tr class="even">
<td align="left">bad</td>
<td align="right">130</td>
<td align="right">82</td>
<td align="right">1.1578012</td>
<td align="right">0.0078271</td>
<td align="right">0.0025752</td>
</tr>
<tr class="odd">
<td align="left">worst</td>
<td align="right">47</td>
<td align="right">39</td>
<td align="right">1.9009588</td>
<td align="right">0.0028298</td>
<td align="right">0.0012483</td>
</tr>
<tr class="even">
<td align="left">pretty</td>
<td align="right">54</td>
<td align="right">41</td>
<td align="right">1.8509483</td>
<td align="right">0.0032512</td>
<td align="right">0.0010729</td>
</tr>
<tr class="odd">
<td align="left">poor</td>
<td align="right">42</td>
<td align="right">34</td>
<td align="right">2.0381599</td>
<td align="right">0.0025287</td>
<td align="right">0.0009771</td>
</tr>
<tr class="even">
<td align="left">guy</td>
<td align="right">56</td>
<td align="right">28</td>
<td align="right">2.2323159</td>
<td align="right">0.0033717</td>
<td align="right">0.0009248</td>
</tr>
<tr class="odd">
<td align="left">part</td>
<td align="right">57</td>
<td align="right">43</td>
<td align="right">1.8033203</td>
<td align="right">0.0034319</td>
<td align="right">0.0008955</td>
</tr>
<tr class="even">
<td align="left">black</td>
<td align="right">41</td>
<td align="right">20</td>
<td align="right">2.5687881</td>
<td align="right">0.0024685</td>
<td align="right">0.0008870</td>
</tr>
<tr class="odd">
<td align="left">minutes</td>
<td align="right">44</td>
<td align="right">32</td>
<td align="right">2.0987845</td>
<td align="right">0.0026492</td>
<td align="right">0.0008588</td>
</tr>
<tr class="even">
<td align="left">stupid</td>
<td align="right">31</td>
<td align="right">24</td>
<td align="right">2.3864666</td>
<td align="right">0.0018665</td>
<td align="right">0.0008519</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># what about bi-grams?</span></span>
<span><span class="va">tf_sentiment_bigram</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tf_sentiment</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">term</span>, <span class="st">"_"</span><span class="op">)</span> , <span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">prob_lift</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> , <span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_sentiment_bigram</span><span class="op">$</span><span class="va">positive</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant bigrams for positive
sentiment</caption>
<colgroup>
<col width="25%">
<col width="13%">
<col width="12%">
<col width="12%">
<col width="22%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">makes_movie</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">3.397022</td>
<td align="right">0.0005916</td>
<td align="right">0.0002932</td>
</tr>
<tr class="even">
<td align="left">good_movie</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">2.837406</td>
<td align="right">0.0008283</td>
<td align="right">0.0002911</td>
</tr>
<tr class="odd">
<td align="left">high_school</td>
<td align="right">11</td>
<td align="right">5</td>
<td align="right">3.867026</td>
<td align="right">0.0006508</td>
<td align="right">0.0002629</td>
</tr>
<tr class="even">
<td align="left">star_wars</td>
<td align="right">9</td>
<td align="right">5</td>
<td align="right">3.867026</td>
<td align="right">0.0005324</td>
<td align="right">0.0002340</td>
</tr>
<tr class="odd">
<td align="left">great_movie</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">3.397022</td>
<td align="right">0.0004733</td>
<td align="right">0.0002047</td>
</tr>
<tr class="even">
<td align="left">highly_recommended</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">3.684704</td>
<td align="right">0.0003550</td>
<td align="right">0.0001759</td>
</tr>
<tr class="odd">
<td align="left">great_film</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">3.530553</td>
<td align="right">0.0004733</td>
<td align="right">0.0001749</td>
</tr>
<tr class="even">
<td align="left">movie_great</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">3.530553</td>
<td align="right">0.0004733</td>
<td align="right">0.0001749</td>
</tr>
<tr class="odd">
<td align="left">academy_award</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">4.090169</td>
<td align="right">0.0002958</td>
<td align="right">0.0001466</td>
</tr>
<tr class="even">
<td align="left">acting_great</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">3.867026</td>
<td align="right">0.0002958</td>
<td align="right">0.0001466</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tf_sentiment_bigram</span><span class="op">$</span><span class="va">negative</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Reweighted: ten most relevant bigrams for negative
sentiment</caption>
<colgroup>
<col width="22%">
<col width="14%">
<col width="12%">
<col width="12%">
<col width="23%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">term</th>
<th align="right">term_freq</th>
<th align="right">doc_freq</th>
<th align="right">idf</th>
<th align="right">conditional_prob</th>
<th align="right">prob_lift</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">waste_time</td>
<td align="right">16</td>
<td align="right">14</td>
<td align="right">2.925463</td>
<td align="right">0.0009633</td>
<td align="right">0.0004561</td>
</tr>
<tr class="even">
<td align="left">special_effects</td>
<td align="right">20</td>
<td align="right">16</td>
<td align="right">2.791932</td>
<td align="right">0.0012042</td>
<td align="right">0.0003686</td>
</tr>
<tr class="odd">
<td align="left">movie_made</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">3.261935</td>
<td align="right">0.0006021</td>
<td align="right">0.0002440</td>
</tr>
<tr class="even">
<td align="left">make_sense</td>
<td align="right">9</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0005419</td>
<td align="right">0.0002136</td>
</tr>
<tr class="odd">
<td align="left">scooby_doo</td>
<td align="right">8</td>
<td align="right">4</td>
<td align="right">4.178226</td>
<td align="right">0.0004817</td>
<td align="right">0.0002131</td>
</tr>
<tr class="even">
<td align="left">worst_movie</td>
<td align="right">7</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0004215</td>
<td align="right">0.0002126</td>
</tr>
<tr class="odd">
<td align="left">part_movie</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0004817</td>
<td align="right">0.0001833</td>
</tr>
<tr class="even">
<td align="left">read_book</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">3.485079</td>
<td align="right">0.0004817</td>
<td align="right">0.0001833</td>
</tr>
<tr class="odd">
<td align="left">good_idea</td>
<td align="right">6</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0003612</td>
<td align="right">0.0001822</td>
</tr>
<tr class="even">
<td align="left">main_character</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">3.772761</td>
<td align="right">0.0004817</td>
<td align="right">0.0001534</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tommy Jones.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '3c26218210734fb0fe605f17d745faba',
    indexName: 'rtextminer',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
